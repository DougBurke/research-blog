<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
        <title>Doug's research blog - Sanity checks</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css"></link>
    </head>
    <body>
        <h1>Doug's research blog - Sanity checks</h1>
        <div id="navigation">
            <a href="../index.html">Home</a>
	    <a href="../intro.html">Introduction</a>
            <a href="../posts.html">All posts</a>
	    <a href="../acknowledge.html">Acknowledgements</a>
        </div>

        <h1>Sanity checks</h1>

<p>by <em>Douglas Burke</em> on <strong>24 October 2012</strong></p>

<p>Before extracting spectra, let’s do some sanity checks.</p>
<h2 id="background-flares">Background flares</h2>
<p>Chandra observations can be affected by “background flares”; that is periods of time when the particle background is not constant (for more information see the <a href="http://cxc.harvard.edu/cal/Acis/Cal_prods/bkgrnd/current/">ACIS Background Memos page</a> from the <a href="http://cxc.harvard.edu/cal/">Calibration team</a>). This flaring need not be a problem for analysis of bright pint sources, but as we are interested in faint, extended emission it is worth checking the high-energy light curve for signs of variability.</p>
<p>Since ACIS has essentially no sensitivity above 9 keV, we chose to look at the 10 to 12 keV data, which is created by the particle background, for the ACIS-I0 and ACIS-I2 chips (these are the two that lie close to the group).</p>
<pre><code>% punlearn dmextract
% dmextract &quot;1655/repro/acisf01655_repro_evt2.fits[ccd_id=0,2,energy=10000:12000][bin time=::500]&quot; qbg.lc opt=ltc1
% dmlist qbg.lc cols
 
--------------------------------------------------------------------------------
Columns for Table Block LIGHTCURVE
--------------------------------------------------------------------------------
 
ColNo  Name                 Unit        Type             Range
   1   TIME_BIN             channel      Int4           1:45                 S/C TT corresponding to mid-exposure
   2   TIME_MIN             s            Real8          97141592.4202499986: 97163977.9086109996 Minimum Value in Bin
   3   TIME                 s            Real8          97141592.4202499986: 97163977.9086109996 S/C TT corresponding to mid-exposure
   4   TIME_MAX             s            Real8          97141592.4202499986: 97163977.9086109996 Maximum Value in Bin
   5   COUNTS               count        Int4           -                    Counts
   6   STAT_ERR             count        Real8          0:+Inf               Statistical error
   7   AREA                 pixel**2     Real8          -Inf:+Inf            Area of extraction
   8   EXPOSURE             s            Real8          -Inf:+Inf            Time per interval
   9   COUNT_RATE           count/s      Real8          0:+Inf               Rate
  10   COUNT_RATE_ERR       count/s      Real8          0:+Inf               Rate Error
 
--------------------------------------------------------------------------------
World Coord Transforms for Columns in Table Block LIGHTCURVE
--------------------------------------------------------------------------------
 
ColNo    Name
2:    DT_MIN               = +0 [s] +1.0 * (TIME_MIN  -97141842.420250)
3:    DT                   = +0 [s] +1.0 * (TIME  -97141842.420250)
4:    DT_MAX               = +0 [s] +1.0 * (TIME_MAX  -97141842.420250)</code></pre>
<p>Plotting up the count rate gives us the following (since I use the “virtual” columns <code>DT_MIN</code> and <code>DT_MAX</code> to plot up the time since the start of the observation, I have to work around a bug in Crates in CIAO 4.4 which means the data needs to be re-shaped to exclude garbage values):</p>
<pre><code>% chips
-----------------------------------------
Welcome to ChIPS: CXC's Plotting Package
-----------------------------------------
CIAO 4.4 ChIPS version 1 Tuesday, June 5, 2012

chips-1&gt; cr = read_file(&quot;qbg.lc&quot;)
chips-2&gt; xlo = cr.get_column(&quot;dt_min&quot;).values
chips-3&gt; xhi = cr.get_column(&quot;dt_max&quot;).values
chips-4&gt; xlo.shape
         (45, 2)
chips-5&gt; xlo = xlo.reshape(45*2)[:45]
chips-6&gt; xhi = xhi.reshape(45*2)[:45]
chips-7&gt; y = cr.get_column(&quot;count_rate&quot;).values
chips-8&gt; dy = cr.get_column(&quot;count_rate_err&quot;).values
chips-9&gt; add_window(8, 5, &quot;inches&quot;)
chips-10&gt; add_histogram(xlo, xhi, y, dy)
chips-11&gt; set_plot_xlabel(r&quot;\Delta T (s)&quot;)
chips-12&gt; set_plot_ylabel(&quot;Count rate (s^{-1])&quot;)
chips-13&gt; set_plot_title(&quot;10 - 12 keV lightcurve for ACIS-I0,I2&quot;)
chips-14&gt; set_axis(&quot;all&quot;, [&quot;label.size&quot;, 20, &quot;ticklabel.size&quot;, 16])
chips-15&gt; set_plot([&quot;title.size&quot;, 20])
chips-16&gt; set_plot_ylabel(&quot;Count rate (s^{-1})&quot;)
chips-17&gt; print_qindow('qbg.png')
NameError: name 'print_qindow' is not defined
chips-18&gt; print_window('qbg.png')
chips-19&gt; quit()</code></pre>
<div class="figure">
<img src="../images/qbg.png" alt="The light curve of the 10 to 12 keV particles in the ACIS-I0 and I2 chips looks consistent."></img><p class="caption">The light curve of the 10 to 12 keV particles in the ACIS-I0 and I2 chips looks consistent.</p>
</div>
<h2 id="source-detection">Source Detection</h2>
<p>Using the binned-by-2 data from yesterday, let’s get a source list since we can use it as a more accurate source location, and for identifying a source-free region for analysis later on.</p>
<p>For this I shall use the <a href="http://cxc.harvard.edu/ciao/ahelp/wavdetect.html"><code>wavdetect</code></a> tool provided in CIAO, roughly following the <a href="http://cxc.harvard.edu/ciao/threads/wavdetect/">running wavdetect thread</a>.</p>
<pre><code>% cd qimg
% punlearn mkspfmap
% mkpsfmap broad_thresh.img broad.psfmap 1.4967 0.393</code></pre>
<p>The PSF map isn’t interesting visually - it basically shows that the PSF increases as you move further away from the aimpoint - but we can get an estimate for the PSF size at the location of the group:</p>
<pre><code>% dmstat &quot;broad.psfmap[sky=circle(7:16:44.3,37:39:55,2&quot;&quot;)]&quot; cen- sig-
broad.psfmap[arcsec]
    min:	3.2938494682 	      @:	( 4961.5 3699.5 )
    max:	3.3122434616 	      @:	( 4963.5 3697.5 )
   mean:	3.3030492663 
    sum:	13.212197065 
   good:	4 
   null:	5 </code></pre>
<p>So at 1.5 keV the PSF size (at which the enclosed energy fraction is 39.3 percent) is about 3.3 arcsec.</p>
<p>Since I am using the whole ACIS-I array here, I include the exposure map to reduce problems at the gaps between the chips, and use a range of scales to better model the extended emission from the cluster (even though we are not interested in this emission here). Note that I do not go above a scale size of 64 to avoid <a href="http://cxc.harvard.edu/ciao4.4/bugs/wavdetect.html#stringlen">a known bug with large scale sizes</a> in CIAO 4.4; for the analysis presented here, which does not use data near the cluster, the lack of these large scales is not a problem.</p>
<pre><code>% punlearn wavdetect
% wavdetect broad_thresh.img src.fits scell.fits wimg.fits wbkg.fits \
      scales=&quot;2 4 8 16 32 64&quot; psffile=broad.psfmap regfile=src.reg \
      expfile=broad_thresh.expmap
% ds9 broad_flux.img -region ../1655/repro/acisf01655_000N003_f1.fits \
      -region color white -region src.fits -log -pan to 4950 3700 \
      wimg.fits -cmap b -region color blue -region width 2 \
      -region src.fits -scale mode 99.5 -pan to 4950 3700</code></pre>
<div class="figure">
<img src="../images/wav-out.png" alt="The white ellipses on the left/blue on the right show the sources detected by wavdetect. The image on the left is the broad-band (0.5 to 7.0 keV) image, with green lines indicating the chip edges, and the image no the right is the wavelet-reconstructed source image, shown with a log scale to highlight the extended emission around the source of interest. I was slightly surprised to see this extended emission, but it’s a nice confirmation that I am not imagining things. Since the source lies right next to the chip edge I am not going to use this reconstruction for charecterising the source emission."></img><p class="caption">The white ellipses on the left/blue on the right show the sources detected by wavdetect. The image on the left is the broad-band (0.5 to 7.0 keV) image, with green lines indicating the chip edges, and the image no the right is the wavelet-reconstructed source image, shown with a log scale to highlight the extended emission around the source of interest. I was slightly surprised to see this extended emission, but it’s a nice confirmation that I am not imagining things. Since the source lies right next to the chip edge I am not going to use this reconstruction for charecterising the source emission.</p>
</div>
<p>Looking at the source list, restricting to close to the group, I find three sources - since</p>
<pre><code>% dmlist &quot;src.fits[pos=circle(4950,3700,250)]&quot; counts</code></pre>
<p>and some of the source properties are</p>
<pre><code>% dmlist &quot;src.fits[pos=circle(4950,3700,250)][cols pos,ra,dec,src_significance,net_counts,net_counts_err,r,rotang,psfratio]&quot; data
 
--------------------------------------------------------------------------------
Data for Table Block SRCLIST
--------------------------------------------------------------------------------
 
ROW    POS(X,Y)                                 RA                   DEC                  SRC_SIGNIFICANCE     NET_COUNTS           NET_COUNTS_ERR       R[2]                                     ROTANG               PSFRATIO
 
     1 (     4778.0714285714,     3766.2142857143)       109.2164132207        37.6746305192         4.9632539749        12.4653091431         3.7416591644 [       10.0189418793         9.7587423325]        17.4122447968     0.73306226730347
     2 (     4962.7345679012,     3700.7592592593)       109.1845457936        37.6656490623        15.8159770966        70.0091934204         9.0000047684 [       45.8681144714        22.9423046112]       117.1847610474         1.6089938879
     3 (     4898.2777777778,     3864.8333333333)       109.1956322045        37.6880859683        12.2616348267        32.9132995605         5.9160809517 [        9.3221349716         5.0649147034]        18.7779579163     0.43097385764122</code></pre>
<p>so the source location (the second row in the table) is RA=109.1845457936 degrees and Dec=37.6656490623 which we can convert into sexagessimal notation:</p>
<pre><code>% chips
-----------------------------------------
Welcome to ChIPS: CXC's Plotting Package
-----------------------------------------
CIAO 4.4 ChIPS version 1 Tuesday, June 5, 2012

chips-1&gt; import coords.format as fmt
chips-2&gt; fmt.deg2ra(109.1845457936, ':')
         '7:16:44.290990464'
chips-3&gt; fmt.deg2dec(37.6656490623, ':')
         '37:39:56.33662428'
chips-4&gt; quit()</code></pre>
<p>so RA=<span class="math">7<sup><em>h</em></sup></span> <span class="math">16<sup><em>m</em></sup></span> <span class="math">44. 3<sup><em>s</em></sup></span> and Dec=<span class="math"> + 37<sup><em>o</em></sup></span> 39’ 56&quot;, and we can use <a href="http://cxc.harvard.edu/ciao/ahelp/dmcoords.html">dmcoords</a> to find it’s location on the ACIS-I array:</p>
<pre><code>% dmcoords broad_flux.img ../1655/primary/pcadf097142619N003_asol1.fits 
dmcoords&gt;: sky 4962.73 3700.76
(RA,Dec):     07:16:44.291    +37:39:56.33   
(RA,Dec):      109.18455       37.66565 deg
THETA,PHI          7.809'        206.76 deg
(Logical):        1006.61        433.63
SKY(X,Y):         4962.73       3700.76
DETX,DETY         3246.13       3667.75
CHIP ACIS-I0       993.50        220.96
TDET              3281.96       4138.50
dmcoords&gt;: quit</code></pre>


    </body>
</html>
